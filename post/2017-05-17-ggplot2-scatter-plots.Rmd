---
title: 'ggplot2: Scatter Plots'
date: '2016-03-09'
slug: ggplot2-scatter-plots
topics:
  - ggplot2
tags:
  - ggplot2
  - visualization
draft: yes
---

[![Twitter](http://i.imgur.com/tXSoThF.png)](https://twitter.com/login?redirect_after_login=%2Fhome%3Fstatus)
[![Facebook](http://i.imgur.com/P3YfQoD.png)](https://www.facebook.com/sharer/sharer.php?u=)

# Introduction

This is the fifth post in the series **Elegant Data Visualization with ggplot2**. In the previous [post](https://rsquaredacademy.github.io/blog/post/ggplot2-introduction-to-aesthetics/), we learnt about aesthetics. In this post, we will build scatter plots by applying everything we have learnt so far.

```{r scat1, echo=FALSE, eval=TRUE, results='hide', message=FALSE}
library(ggplot2)
library(dplyr)
library(tidyr)
```

```{r import, echo=FALSE, eval=TRUE, results='hide', message=FALSE}
ecom <- readr::read_csv('https://raw.githubusercontent.com/rsquaredacademy/datasets/master/web.csv')
```

## Basic Plot

We will continue to use the ecommerce data. You can download it from [here](https://github.com/rsquaredacademy/datasets/blob/master/web.csv) or import directly using the readr package.

```{r import2, echo=FALSE, eval=FALSE, results='hide', message=FALSE}
ecom <- readr::read_csv('https://raw.githubusercontent.com/rsquaredacademy/datasets/master/web.csv')
```

Let us start by building a simple scatter plot. 

```{r scat2}
ggplot(ecom) +
  geom_point(aes(n_pages, duration))
```

Let us add some random variation to the location of each point to handle overplotting. Use the `position` argument and set it to `jitter`.

```{r scat22}
ggplot(ecom) +
  geom_point(aes(n_pages, duration), position = 'jitter')
```

You can use the `geom_jitter()` function to achieve the above result.

```{r scat3}
ggplot(ecom) +
  geom_jitter(aes(n_pages, duration))
```

## Color

Now let us modify the color of the points. There are two ways:

- map color to variable using the `aes()` function
- specify colors separately

Map color to variables.

- Categorical Variable

```{r scat4}
ggplot(ecom) +
  geom_point(aes(n_pages, duration, color = factor(purchase)), 
             position = 'jitter')
```

- Continuous Variable

```{r scat5}
ggplot(ecom) +
  geom_point(aes(n_pages, duration, color = order_items), 
             position = 'jitter')
```

Let us specify the color of the points separately. 

```{r scat6}
ggplot(ecom) +
  geom_point(aes(n_pages, duration), color = 'blue', 
             position = 'jitter')
```

Use `alpha` argument to specify the transparency of the points.

```{r scat7}
ggplot(ecom) +
  geom_point(aes(n_pages, duration), color = 'blue', alpha = 0.4, 
             position = 'jitter')
```

## Shape

- Map shape to variable.

We can map shape to a categorical variable only.

```{r scat8}
ggplot(ecom) +
  geom_point(aes(n_pages, duration, shape = factor(device)),
             position = 'jitter')
```

Specify value for shape.

```{r scat9}
ggplot(ecom) +
  geom_point(aes(n_pages, duration), shape = 3,
             position = 'jitter')
```

## Size

- Map size to variable.

It is advised to map size to a continuous variable.

```{r scat10}
ggplot(ecom) +
  geom_point(aes(n_pages, duration, size = n_visit), color = 'blue',
             position = 'jitter')
```

Specify value for shape.

```{r scat11}
ggplot(ecom) +
  geom_point(aes(n_pages, duration), size = 3,
             position = 'jitter')
```


## Fit Line

You can fit a line using either `geom_abline()` or `geom_smooth()`. 

Use linear regression.

```{r aes12}
ggplot(ecom, aes(n_pages, duration)) +
  geom_point(position = 'jitter') +
  geom_smooth(method = 'lm', se = FALSE)
```

Add a confidence interval for the fitted values.

```{r aes13}
ggplot(ecom, aes(n_pages, duration)) +
  geom_point(position = 'jitter') +
  geom_smooth(method = 'lm', se = TRUE)
```

Use loess regression

```{r aes14}
ggplot(ecom, aes(n_pages, duration)) +
  geom_point(position = 'jitter') +
  geom_smooth(method = 'loess', se = FALSE)
```

```{r aes15}
ggplot(ecom, aes(n_pages, duration)) +
  geom_point(position = 'jitter') +
  geom_smooth(method = 'loess', se = TRUE)
```

If you use `geom_abline()`, specify the intercept and the slope.
Let us regress `duration` on `n_pages` and use the output.

```{r aes16}
lm(duration ~ n_pages, data = ecom)
```

```{r aes17}
ggplot(ecom, aes(n_pages, duration)) +
  geom_point(position = 'jitter') +
  geom_abline(slope = 19.9210, intercept = 0.2199)
```

## Summary

In this post, we learnt to:

- build scatter plots
- map aesthetics to variables
- modify axis and legend
- fit regression line

In the next [post](https://rsquaredacademy.github.io/blog/post/ggplot2-line-graphs/), we will learn to build line charts.

